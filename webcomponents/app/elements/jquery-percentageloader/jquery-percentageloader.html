<link rel="import" href="../../bower_components/polymer/polymer.html">

<script src="jquery-1.11.1.min.js"></script>
<script src="jquery-percentageloader.js"></script>

<polymer-element name="jquery-percentageloader" attributes="progress value width height controllable">
  <template>
    <link rel="stylesheet" href="jquery-percentageloader.css">
    <div id="container"></div>
  </template>

  <script>
    (function () {
      'use strict';


      Polymer({

        width: 250,
        height: 250,
        progress: 0.5,
        controllable: false,
        value: 1024000,

        // define element prototype here
        domReady: function() {
          this.loader = $(this.$.container).percentageLoader({
            width: this.width, height: this.height
          });
          this.loader.setValue(this.bytesToSize(this.value));
          this.loader.setProgress(this.progress);
        },

        valueChanged: function(oldVal, newVal) {
          this.loader.setValue(this.bytesToSize(newVal));
        },

        progressChanged: function(oldVal, newVal) {
          this.loader.setProgress(newVal);
        },

        /*
         bytes: bytes of data
         fn: number of fixed, default is 2
         */
        bytesToSize: function(bytes, fn) {
          if (!fn) fn = 2;
          var sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];
          if (bytes == 0) return '0Bytes';
          var i = parseInt(Math.floor(Math.log(bytes) / Math.log(1024)));
          if (i == 0) return bytes + '' + sizes[i];
          return (bytes / Math.pow(1024, i)).toFixed(fn) + '' + sizes[i];
        }
      });

    })();
  </script>
</polymer-element>
